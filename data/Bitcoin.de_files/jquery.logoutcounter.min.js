!(function(e) {
	function t() {
		e.fn.isHtml5Supported() &&
			(
				localStorage.setItem(o("remainingTime"), r.logoutTimerValue),
				"object" == typeof u && u.html(i(localStorage.getItem(o("remainingTime"))))
			);
	}
	function i(e) {
		var t, i, n;
		return e > 0
			? (
					(t = e),
					(i = 3600 == t ? 60 : Math.floor(t / 60) % 60),
					(n = t % 60),
					(i = 10 > i ? "0" + i : i),
					(n = 10 > n ? "0" + n : n)
				)
			: ((i = "00"), (n = "00")), i + ":" + n;
	}
	function n(l) {
		var s = i(l);
		60 > l ? u.addClass("low_time") : u.removeClass("low_time"), l > 0
			? (f = window.setTimeout(function() {
					e.fn.isHtml5Supported() &&
						(
							(l = localStorage.getItem(o("remainingTime"))),
							window.addEventListener("storage", function(e) {
								e.key == o("remainingTime") &&
									(m = !0), e.key == o("hasMain") && "true" == e.oldValue && "false" == e.newValue && (m = !1);
							}),
							e.fn.isInitialized() &&
								!m &&
								(
									localStorage.setItem(o("remainingTime"), l - 1),
									localStorage.setItem(o("hasMain"), !0),
									e(window).on("unload", function() {
										var e = { value: !1, timestamp: new Date().getTime() };
										localStorage.setItem(
											o("initialized"),
											JSON.stringify(e),
										), localStorage.setItem(o("hasMain"), !1);
									})
								)
						), u.on("ajaxComplete", function() {
						clearInterval(f), t(), n(l);
					}), n(--l);
				}, 1e3))
			: (clearInterval(f), e.fn.isHtml5Supported() && r.reloadSiteAfterExpiration && a()), u.empty(), u.html(s);
	}
	function a() {
		window.location.reload(!0);
	}
	function o(t) {
		return e.fn.varPrefixName() + "_" + t;
	}
	function l() {
		if (e.fn.isHtml5Supported()) {
			var t = JSON.parse(localStorage.getItem(o("initialized")));
			if (
				"undefined" == typeof t ||
				0 == t ||
				null == t ||
				t.timestamp < new Date().getTime() - 1e3 * r.logoutTimerValue
			) {
				var i = { value: !1, timestamp: new Date().getTime() };
				localStorage.setItem(o("initialized"), JSON.stringify(i)), localStorage.setItem(
					o("remainingTime"),
					r.logoutTimerValue,
				), localStorage.setItem(o("hasMain"), !1);
			}
		}
	}
	var r,
		u,
		f,
		m = !1;
	(e.fn.logoutcounter = function(i) {
		return (r = e.extend({}, e.fn.logoutcounter.defaults, i)), this.each(function() {
			(u = e(
				this,
			)), "undefined" != typeof u.data("time") && (r.logoutTimerValue = u.data("time")), l(), t(), n(r.logoutTimerValue);
		});
	}), (e.fn.logoutcounter.defaults = {
		logoutTimerValue: 65,
		reloadSiteAfterExpiration: !0,
		varPrefix: "bitcoin",
	}), (e.fn.isHtml5Supported = function() {
		return "undefined" == typeof e.fn.isHtml5Supported.result &&
			(e.fn.isHtml5Supported.result = !(
				!document.createElement("canvas").getContext ||
				"function" != typeof document.createElement("canvas").getContext("2d").fillText
			)), e.fn.isHtml5Supported.result;
	}), (e.fn.varPrefixName = function() {
		return "undefined" == typeof e.fn.varPrefixName.result && (e.fn.varPrefixName.result = r.varPrefix), e.fn
			.varPrefixName.result;
	}), (e.fn.isInitialized = function() {
		if (e.fn.isHtml5Supported()) {
			if (
				(
					(e.fn.isInitialized.object = JSON.parse(localStorage.getItem(o("initialized")))),
					"undefined" == typeof e.fn.isInitialized.object ||
						null == e.fn.isInitialized.object ||
						"false" == e.fn.isInitialized.object.value ||
						0 == e.fn.isInitialized.object.value ||
						e.fn.isInitialized.object.timestamp < new Date().getTime() - 1e3 * r.logoutTimerValue
				)
			) {
				var t = { value: !0, timestamp: new Date().getTime() };
				localStorage.setItem(o("initialized"), JSON.stringify(t));
			}
			return e.fn.isInitialized.object.value;
		}
		return !1;
	});
})(jQuery);
